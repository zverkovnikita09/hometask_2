(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function p(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(e){if(e.ep)return;e.ep=!0;const r=p(e);fetch(e.href,r)}})();function q(n){const t=document.querySelector(".battleground"),p=t.querySelectorAll(".battle-section"),l=document.querySelector(".win-line"),e=document.querySelector(".current-player"),r=document.querySelector(".end-popup"),u=r.querySelector(".reload-game"),y=o=>{e.className=`current-player turn-${o}`,e.innerHTML=`Ход игрока <span class="player">${n[o]}</span>`};y("x");let s="x";const L=()=>{t.className=`battleground turn-${s}`},x=[{condition:[0,1,2],transformLine:[0,-120,0]},{condition:[3,4,5],transformLine:[0,0,0]},{condition:[6,7,8],transformLine:[0,120,0]},{condition:[0,3,6],transformLine:[-120,0,90]},{condition:[1,4,7],transformLine:[0,0,90]},{condition:[2,5,8],transformLine:[120,0,90]},{condition:[0,4,8],transformLine:[0,0,45]},{condition:[2,4,6],transformLine:[0,0,-45]}];let i,a=Array(9).fill(null);L();const h=()=>{r.classList.remove("active"),y("x"),t.classList.remove("unclickable"),p.forEach(o=>o.className="battle-section"),i=void 0,a=a.map(o=>null),l.className="win-line",s="x",L()},P=()=>{s==="x"?(s="o",L(),y("o")):(s="x",L(),y("x"))},T=()=>{let o;return o=x.some(c=>c.condition.every(d=>{if(!a[d])return!1;if(a[d]===s)return!0})?(i=c,!0):!1),a.every(c=>c!==null)&&!i&&(o=!0),o};t.addEventListener("click",o=>{const c=o.target.closest(".battle-section");if(!a[c.dataset.index]){if(c.classList.add("filled",`fill-${s}`),a[c.dataset.index]=s,T()){t.classList.add("unclickable"),p.forEach(d=>{i!=null&&i.condition.includes(Number(d.dataset.index))||d.classList.add("gray")}),r.classList.add("active"),u.addEventListener("click",h),i?(l.classList.add("visible",`color-${s}`),l.style.transform=`translate(${i.transformLine[0]}px, ${i.transformLine[1]}px) rotate(${i.transformLine[2]}deg)`,r.querySelector(".winner").innerHTML=`Победил игрок <span class="name win-${s}">${n[s]}</span>`):r.querySelector(".winner").innerHTML="Ничья";return}P()}})}const m=document.querySelector(".start-popup"),g=m.querySelector(".step-1"),v=m.querySelector(".step-2"),f=m.querySelector(".first-turn");let S,b;g.addEventListener("submit",n=>{const t=g.querySelector("input");n.preventDefault(),t.value&&(S=t.value,$())});function $(){g.classList.remove("active"),v.classList.add("active");const n=v.querySelector("input");n.value="",n.focus(),v.addEventListener("submit",t=>{t.preventDefault(),n.value&&(b=n.value,E())})}function E(){v.classList.remove("active"),f.classList.add("active");const n=f.querySelector(".player-button.is--1"),t=f.querySelector(".player-button.is--2");n.innerText=S,n.addEventListener("click",()=>{m.classList.remove("active"),f.classList.remove("active"),q({x:S,o:b})}),t.innerText=b,t.addEventListener("click",()=>{m.classList.remove("active"),f.classList.remove("active"),q({x:b,o:S})})}
