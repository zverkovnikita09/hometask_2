(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function p(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(e){if(e.ep)return;e.ep=!0;const r=p(e);fetch(e.href,r)}})();function q(n){const t=document.querySelector(".battleground"),p=t.querySelectorAll(".battle-section"),l=document.querySelector(".win-line"),e=document.querySelector(".current-player"),r=document.querySelector(".end-popup"),u=r.querySelector(".reload-game"),y=s=>{e.className=`current-player turn-${s}`,e.innerHTML=`Ход игрока <span class="player">${n[s]}</span>`};y("x");let o="x";const S=()=>{t.className=`battleground turn-${o}`},x=[{condition:[0,1,2],transformLine:[0,-120,0]},{condition:[3,4,5],transformLine:[0,0,0]},{condition:[6,7,8],transformLine:[120,0,0]},{condition:[0,3,6],transformLine:[-120,0,90]},{condition:[1,4,7],transformLine:[0,0,90]},{condition:[2,5,8],transformLine:[120,0,90]},{condition:[0,4,8],transformLine:[0,0,45]},{condition:[2,4,6],transformLine:[0,0,-45]}];let i,a=Array(9).fill(null);S();const h=()=>{r.classList.remove("active"),y("x"),t.classList.remove("unclickable"),p.forEach(s=>s.className="battle-section"),i=void 0,a=a.map(s=>null),l.classList.remove("visible")},P=()=>{o==="x"?(o="o",S(),y("o")):(o="x",S(),y("x"))},T=()=>{let s;return s=x.some(c=>c.condition.every(d=>{if(!a[d])return!1;if(a[d]===o)return!0})?(i=c,!0):!1),a.every(c=>c!==null)&&!i&&(s=!0),s};t.addEventListener("click",s=>{const c=s.target.closest(".battle-section");if(!a[c.dataset.index]){if(c.classList.add("filled",`fill-${o}`),a[c.dataset.index]=o,T()){t.classList.add("unclickable"),p.forEach(d=>{i!=null&&i.condition.includes(Number(d.dataset.index))||d.classList.add("gray")}),r.classList.add("active"),u.addEventListener("click",h),i?(l.classList.add("visible",`color-${o}`),l.style.transform=`translate(${i.transformLine[0]}px, ${i.transformLine[1]}px) rotate(${i.transformLine[2]}deg)`,r.querySelector(".winner").innerHTML=`Победил игрок <span class="name win-${o}">${n[o]}</span>`):r.querySelector(".winner").innerHTML="Ничья";return}P()}})}const m=document.querySelector(".start-popup"),g=m.querySelector(".step-1"),L=m.querySelector(".step-2"),f=m.querySelector(".first-turn");let v,b;g.addEventListener("submit",n=>{const t=g.querySelector("input");n.preventDefault(),t.value&&(v=t.value,$())});function $(){g.classList.remove("active"),L.classList.add("active");const n=L.querySelector("input");n.value="",n.focus(),L.addEventListener("submit",t=>{t.preventDefault(),n.value&&(b=n.value,E())})}function E(){L.classList.remove("active"),f.classList.add("active");const n=f.querySelector(".player-button.is--1"),t=f.querySelector(".player-button.is--2");n.innerText=v,n.addEventListener("click",()=>{m.classList.remove("active"),f.classList.remove("active"),q({x:v,o:b})}),t.innerText=b,t.addEventListener("click",()=>{m.classList.remove("active"),f.classList.remove("active"),q({x:b,o:v})})}
